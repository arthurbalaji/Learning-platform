{"ast":null,"code":"var _jsxFileName = \"E:\\\\Learning platform\\\\React-frontend\\\\src\\\\Pages\\\\Learn.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useContext } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { UserContext } from '../Contexts/User';\nimport { Button, Typography, Box, Container, List, ListItem, ListItemText, ListItemIcon, CircularProgress } from '@mui/material';\nimport CheckCircleIcon from '@mui/icons-material/CheckCircle';\nimport RadioButtonUncheckedIcon from '@mui/icons-material/RadioButtonUnchecked';\nimport YouTube from 'react-youtube';\nimport PopupGame from './popupgame';\nimport Webcam from 'react-webcam';\n\n// YouTube video options\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst youtubeOpts = {\n  height: '390',\n  width: '640',\n  playerVars: {\n    autoplay: 0,\n    controls: 1,\n    rel: 0,\n    // Don't show related videos\n    modestbranding: 1,\n    // Hide YouTube logo\n    origin: window.location.origin // Add origin for security\n  }\n};\n\n// Extract YouTube video ID from URL\nconst getYouTubeVideoId = url => {\n  if (!url) return null;\n\n  // Handle different YouTube URL formats\n  const regExp = /^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|&v=)([^#&?]*).*/;\n  const match = url.match(regExp);\n  return match && match[2].length === 11 ? match[2] : null;\n};\n\n// Add this function after getYouTubeVideoId\nconst isFinalQuizEnabled = (course, completedLessons) => {\n  return course.lessons.every(lesson => completedLessons.some(completed => completed.id === lesson.id));\n};\nconst Learn = () => {\n  _s();\n  const {\n    courseId,\n    lessonId\n  } = useParams();\n  const [course, setCourse] = useState(null);\n  const [lesson, setLesson] = useState(null);\n  const [completedLessons, setCompletedLessons] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n  const {\n    user\n  } = useContext(UserContext);\n  const navigate = useNavigate();\n  const [videoError, setVideoError] = useState(false);\n  const [showGame, setShowGame] = useState(false);\n  const [emotionTimer, setEmotionTimer] = useState(null);\n  const webcamRef = React.useRef(null);\n  useEffect(() => {\n    const fetchCourse = async () => {\n      setLoading(true);\n      setError(null);\n      try {\n        // Check if user has completed intro quiz\n        const introQuizResponse = await axios.get(`http://localhost:8080/users/${user.id}/courses/${courseId}/intro-quiz-summaries`);\n        if (!introQuizResponse.data || introQuizResponse.data.length === 0) {\n          navigate(`/courses/${courseId}/introductory-quiz`);\n          return;\n        }\n        try {\n          // Split the Promise.all to handle completed lessons separately\n          const [courseResponse, lessonResponse] = await Promise.all([axios.get(`http://localhost:8080/courses/${courseId}`), axios.get(`http://localhost:8080/courses/${courseId}/lessons/${lessonId}`)]);\n          setCourse(courseResponse.data);\n          setLesson(lessonResponse.data);\n\n          // Handle completed lessons separately with error fallback\n          try {\n            const completedLessonsResponse = await axios.get(`http://localhost:8080/courses/${courseId}/users/${user.id}/completed-lessons`);\n            setCompletedLessons(completedLessonsResponse.data || []);\n          } catch (completedError) {\n            console.warn('Error fetching completed lessons:', completedError);\n            setCompletedLessons([]); // Set empty array as fallback\n          }\n        } catch (dataError) {\n          console.error('Error fetching course/lesson data:', dataError);\n          setError('Failed to load course content. Please try again.');\n        }\n      } catch (introQuizError) {\n        console.error('Error checking intro quiz:', introQuizError);\n        navigate(`/courses/${courseId}/introductory-quiz`);\n      } finally {\n        setLoading(false);\n      }\n    };\n    if (user && courseId && lessonId) {\n      fetchCourse();\n    }\n  }, [courseId, lessonId, user, navigate]);\n\n  // Update the checkEmotion function\n  const checkEmotion = async () => {\n    if (webcamRef.current) {\n      try {\n        // Force webcam refresh\n        const video = webcamRef.current.video;\n        if (video) {\n          video.srcObject = await navigator.mediaDevices.getUserMedia({\n            video: {\n              width: 640,\n              height: 480,\n              frameRate: {\n                ideal: 30\n              }\n            }\n          });\n        }\n\n        // Wait for new frame\n        await new Promise(resolve => setTimeout(resolve, 1000));\n        const imageSrc = webcamRef.current.getScreenshot();\n        if (!imageSrc) {\n          console.error('Failed to capture webcam image');\n          return;\n        }\n        const timestamp = new Date().toISOString();\n        console.log('Capturing frame at:', timestamp);\n        const response = await axios.post('http://localhost:5000/analyze-emotion', {\n          image: imageSrc,\n          timestamp: timestamp\n        }, {\n          headers: {\n            'Content-Type': 'application/json'\n          }\n        });\n        console.log('Frame stats:', response.data.frame_stats);\n        console.log('Emotion scores:', response.data.emotion_scores);\n        if (response.data.needs_break) {\n          setShowGame(true);\n          if (emotionTimer) {\n            clearInterval(emotionTimer);\n            setEmotionTimer(null);\n          }\n        }\n      } catch (error) {\n        var _error$response;\n        console.error('Error analyzing emotion:', (_error$response = error.response) === null || _error$response === void 0 ? void 0 : _error$response.data);\n      }\n    }\n  };\n\n  // Update the useEffect for emotion timer\n  useEffect(() => {\n    if (!showGame && !emotionTimer) {\n      const timer = setInterval(checkEmotion, 5 * 1000); // 5 minutes\n      setEmotionTimer(timer);\n    }\n    return () => {\n      if (emotionTimer) {\n        clearInterval(emotionTimer);\n      }\n    };\n  }, [showGame, emotionTimer]);\n  const handleQuiz = async () => {\n    try {\n      // Check if quiz already completed\n      const quizStatusResponse = await axios.get(`http://localhost:8080/courses/${courseId}/lessons/${lessonId}/users/${user.id}/quiz-status`);\n      if (quizStatusResponse.data && quizStatusResponse.data.completed) {\n        // Mark course as in progress if this is the first completed lesson\n        if (completedLessons.length === 0) {\n          try {\n            await axios.post(`http://localhost:8080/users/${user.id}/courses/${courseId}/in-progress`);\n          } catch (error) {\n            console.error('Error marking course as in progress:', error);\n          }\n        }\n\n        // Navigate to next lesson or quiz\n        const currentLessonIndex = course.lessons.findIndex(l => l.id === parseInt(lessonId));\n        const nextLesson = course.lessons[currentLessonIndex + 1];\n        if (nextLesson) {\n          navigate(`/learn/${courseId}/${nextLesson.id}`);\n        } else {\n          // No more lessons, check if final quiz is available\n          const finalQuizResponse = await axios.get(`http://localhost:8080/courses/${courseId}/final-quiz`);\n          if (finalQuizResponse.data) {\n            navigate(`/courses/${courseId}/final-quiz`);\n          } else {\n            navigate(`/courses/${courseId}`);\n          }\n        }\n      } else {\n        // Quiz not completed, navigate to lesson quiz\n        navigate(`/courses/${courseId}/lessons/${lessonId}/quiz`);\n      }\n    } catch (error) {\n      console.error('Error checking quiz status:', error);\n      navigate(`/courses/${courseId}/lessons/${lessonId}/quiz`);\n    }\n  };\n  const handleLessonClick = clickedLessonId => {\n    if (!(course !== null && course !== void 0 && course.lessons)) return;\n    const lessonIndex = course.lessons.findIndex(l => l.id === clickedLessonId);\n\n    // If completedLessons is empty (due to API error), allow clicking any lesson\n    if (completedLessons.length === 0) {\n      navigate(`/learn/${courseId}/${clickedLessonId}`);\n      return;\n    }\n    const previousLessonsCompleted = course.lessons.slice(0, lessonIndex).every(l => completedLessons.some(cl => cl.id === l.id));\n    if (completedLessons.some(cl => cl.id === clickedLessonId) || previousLessonsCompleted) {\n      navigate(`/learn/${courseId}/${clickedLessonId}`);\n    } else {\n      alert('Please complete previous lessons first');\n    }\n  };\n  if (loading) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      alignItems: \"center\",\n      minHeight: \"100vh\",\n      children: /*#__PURE__*/_jsxDEV(CircularProgress, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 245,\n      columnNumber: 13\n    }, this);\n  }\n  if (error) {\n    return /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      alignItems: \"center\",\n      minHeight: \"100vh\",\n      children: /*#__PURE__*/_jsxDEV(Typography, {\n        color: \"error\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 253,\n      columnNumber: 13\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(Container, {\n    children: [/*#__PURE__*/_jsxDEV(Typography, {\n      variant: \"h4\",\n      component: \"h1\",\n      mt: 4,\n      children: course.name\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      mt: 4,\n      children: [/*#__PURE__*/_jsxDEV(Box, {\n        flex: 1,\n        children: [lesson.youtubeVideoLink && !videoError && /*#__PURE__*/_jsxDEV(Box, {\n          mb: 3,\n          children: /*#__PURE__*/_jsxDEV(YouTube, {\n            videoId: getYouTubeVideoId(lesson.youtubeVideoLink),\n            opts: youtubeOpts,\n            onError: error => {\n              setVideoError(true);\n              console.error('YouTube Error:', error);\n            }\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 25\n        }, this), videoError && /*#__PURE__*/_jsxDEV(Box, {\n          mb: 3,\n          children: /*#__PURE__*/_jsxDEV(Typography, {\n            color: \"error\",\n            children: \"Failed to load video. Please check your internet connection.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 280,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 279,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(Box, {\n          mt: 2,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            variant: \"contained\",\n            color: \"primary\",\n            onClick: handleQuiz,\n            children: \"Attend Quiz\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 285,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h6\",\n          component: \"h2\",\n          mt: 2,\n          children: lesson.name\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 290,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"body1\",\n          component: \"p\",\n          mt: 2,\n          children: lesson.description\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 293,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 265,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Box, {\n        ml: 4,\n        width: \"300px\",\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h6\",\n          component: \"h2\",\n          children: \"Lessons\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 298,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(List, {\n          children: [course.lessons.map(l => /*#__PURE__*/_jsxDEV(ListItem, {\n            onClick: () => handleLessonClick(l.id),\n            sx: {\n              // Using sx prop instead of style\n              backgroundColor: completedLessons.some(cl => cl.id === l.id) ? '#d3ffd3' : '#ffd3d3',\n              cursor: 'pointer',\n              // Add pointer cursor\n              '&:hover': {\n                opacity: 0.9\n              }\n            },\n            children: [/*#__PURE__*/_jsxDEV(ListItemIcon, {\n              children: completedLessons.some(cl => cl.id === l.id) ? /*#__PURE__*/_jsxDEV(CheckCircleIcon, {\n                color: \"primary\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 318,\n                columnNumber: 41\n              }, this) : /*#__PURE__*/_jsxDEV(RadioButtonUncheckedIcon, {\n                color: \"secondary\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 320,\n                columnNumber: 41\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 316,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(ListItemText, {\n              primary: l.name\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 323,\n              columnNumber: 33\n            }, this)]\n          }, l.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 303,\n            columnNumber: 29\n          }, this)), /*#__PURE__*/_jsxDEV(ListItem, {\n            onClick: () => {\n              if (isFinalQuizEnabled(course, completedLessons)) {\n                navigate(`/courses/${courseId}/final-quiz`);\n              } else {\n                alert('Please complete all lessons before attempting the final quiz');\n              }\n            },\n            sx: {\n              backgroundColor: '#f0f0f0',\n              cursor: 'pointer',\n              '&:hover': {\n                opacity: 0.9\n              },\n              marginTop: 1,\n              borderTop: '2px solid #ddd'\n            },\n            children: [/*#__PURE__*/_jsxDEV(ListItemIcon, {\n              children: /*#__PURE__*/_jsxDEV(RadioButtonUncheckedIcon, {\n                color: \"primary\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 346,\n                columnNumber: 33\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(ListItemText, {\n              primary: \"Final Quiz\",\n              secondary: isFinalQuizEnabled(course, completedLessons) ? \"Ready to take\" : \"Complete all lessons first\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 327,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 301,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 264,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Webcam, {\n      ref: webcamRef,\n      screenshotFormat: \"image/jpeg\",\n      style: {\n        display: 'none'\n      },\n      videoConstraints: {\n        width: 640,\n        height: 480,\n        facingMode: \"user\",\n        frameRate: {\n          ideal: 30\n        }\n      },\n      audio: false,\n      mirrored: false,\n      screenshotQuality: 1.0,\n      forceScreenshotSourceSize: true,\n      onUserMedia: () => console.log('Webcam initialized'),\n      onUserMediaError: err => console.error('Webcam error:', err)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 358,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(PopupGame, {\n      open: showGame,\n      onClose: () => {\n        setShowGame(false);\n        // Resume emotion detection timer\n        if (!emotionTimer) {\n          const timer = setInterval(checkEmotion, 5 * 60 * 1000);\n          setEmotionTimer(timer);\n        }\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 375,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 260,\n    columnNumber: 9\n  }, this);\n};\n_s(Learn, \"BJ4PZCl1H16s31hUDOCCsPRgXkc=\", false, function () {\n  return [useParams, useNavigate];\n});\n_c = Learn;\nexport default Learn;\nvar _c;\n$RefreshReg$(_c, \"Learn\");","map":{"version":3,"names":["React","useState","useEffect","useContext","useParams","useNavigate","axios","UserContext","Button","Typography","Box","Container","List","ListItem","ListItemText","ListItemIcon","CircularProgress","CheckCircleIcon","RadioButtonUncheckedIcon","YouTube","PopupGame","Webcam","jsxDEV","_jsxDEV","youtubeOpts","height","width","playerVars","autoplay","controls","rel","modestbranding","origin","window","location","getYouTubeVideoId","url","regExp","match","length","isFinalQuizEnabled","course","completedLessons","lessons","every","lesson","some","completed","id","Learn","_s","courseId","lessonId","setCourse","setLesson","setCompletedLessons","loading","setLoading","error","setError","user","navigate","videoError","setVideoError","showGame","setShowGame","emotionTimer","setEmotionTimer","webcamRef","useRef","fetchCourse","introQuizResponse","get","data","courseResponse","lessonResponse","Promise","all","completedLessonsResponse","completedError","console","warn","dataError","introQuizError","checkEmotion","current","video","srcObject","navigator","mediaDevices","getUserMedia","frameRate","ideal","resolve","setTimeout","imageSrc","getScreenshot","timestamp","Date","toISOString","log","response","post","image","headers","frame_stats","emotion_scores","needs_break","clearInterval","_error$response","timer","setInterval","handleQuiz","quizStatusResponse","currentLessonIndex","findIndex","l","parseInt","nextLesson","finalQuizResponse","handleLessonClick","clickedLessonId","lessonIndex","previousLessonsCompleted","slice","cl","alert","display","justifyContent","alignItems","minHeight","children","fileName","_jsxFileName","lineNumber","columnNumber","color","variant","component","mt","name","flex","youtubeVideoLink","mb","videoId","opts","onError","onClick","description","ml","map","sx","backgroundColor","cursor","opacity","primary","marginTop","borderTop","secondary","ref","screenshotFormat","style","videoConstraints","facingMode","audio","mirrored","screenshotQuality","forceScreenshotSourceSize","onUserMedia","onUserMediaError","err","open","onClose","_c","$RefreshReg$"],"sources":["E:/Learning platform/React-frontend/src/Pages/Learn.js"],"sourcesContent":["import React, { useState, useEffect, useContext } from 'react';\nimport { useParams, useNavigate } from 'react-router-dom';\nimport axios from 'axios';\nimport { UserContext } from '../Contexts/User';\nimport { Button, Typography, Box, Container, List, ListItem, ListItemText, ListItemIcon, CircularProgress } from '@mui/material';\nimport CheckCircleIcon from '@mui/icons-material/CheckCircle';\nimport RadioButtonUncheckedIcon from '@mui/icons-material/RadioButtonUnchecked';\nimport YouTube from 'react-youtube';\nimport PopupGame from './popupgame';\nimport Webcam from 'react-webcam';\n\n// YouTube video options\nconst youtubeOpts = {\n    height: '390',\n    width: '640',\n    playerVars: {\n        autoplay: 0,\n        controls: 1,\n        rel: 0, // Don't show related videos\n        modestbranding: 1, // Hide YouTube logo\n        origin: window.location.origin // Add origin for security\n    }\n};\n\n// Extract YouTube video ID from URL\nconst getYouTubeVideoId = (url) => {\n    if (!url) return null;\n    \n    // Handle different YouTube URL formats\n    const regExp = /^.*(youtu.be\\/|v\\/|u\\/\\w\\/|embed\\/|watch\\?v=|&v=)([^#&?]*).*/;\n    const match = url.match(regExp);\n\n    return (match && match[2].length === 11) ? match[2] : null;\n};\n\n// Add this function after getYouTubeVideoId\nconst isFinalQuizEnabled = (course, completedLessons) => {\n    return course.lessons.every(lesson => \n        completedLessons.some(completed => completed.id === lesson.id)\n    );\n};\n\nconst Learn = () => {\n    const { courseId, lessonId } = useParams();\n    const [course, setCourse] = useState(null);\n    const [lesson, setLesson] = useState(null);\n    const [completedLessons, setCompletedLessons] = useState([]);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n    const { user } = useContext(UserContext);\n    const navigate = useNavigate();\n    const [videoError, setVideoError] = useState(false);\n    const [showGame, setShowGame] = useState(false);\n    const [emotionTimer, setEmotionTimer] = useState(null);\n    const webcamRef = React.useRef(null);\n\n    useEffect(() => {\n        const fetchCourse = async () => {\n            setLoading(true);\n            setError(null);\n            try {\n                // Check if user has completed intro quiz\n                const introQuizResponse = await axios.get(\n                    `http://localhost:8080/users/${user.id}/courses/${courseId}/intro-quiz-summaries`\n                );\n\n                if (!introQuizResponse.data || introQuizResponse.data.length === 0) {\n                    navigate(`/courses/${courseId}/introductory-quiz`);\n                    return;\n                }\n\n                try {\n                    // Split the Promise.all to handle completed lessons separately\n                    const [courseResponse, lessonResponse] = await Promise.all([\n                        axios.get(`http://localhost:8080/courses/${courseId}`),\n                        axios.get(`http://localhost:8080/courses/${courseId}/lessons/${lessonId}`)\n                    ]);\n\n                    setCourse(courseResponse.data);\n                    setLesson(lessonResponse.data);\n\n                    // Handle completed lessons separately with error fallback\n                    try {\n                        const completedLessonsResponse = await axios.get(\n                            `http://localhost:8080/courses/${courseId}/users/${user.id}/completed-lessons`\n                        );\n                        setCompletedLessons(completedLessonsResponse.data || []);\n                    } catch (completedError) {\n                        console.warn('Error fetching completed lessons:', completedError);\n                        setCompletedLessons([]); // Set empty array as fallback\n                    }\n\n                } catch (dataError) {\n                    console.error('Error fetching course/lesson data:', dataError);\n                    setError('Failed to load course content. Please try again.');\n                }\n\n            } catch (introQuizError) {\n                console.error('Error checking intro quiz:', introQuizError);\n                navigate(`/courses/${courseId}/introductory-quiz`);\n            } finally {\n                setLoading(false);\n            }\n        };\n\n        if (user && courseId && lessonId) {\n            fetchCourse();\n        }\n    }, [courseId, lessonId, user, navigate]);\n\n    // Update the checkEmotion function\n    const checkEmotion = async () => {\n        if (webcamRef.current) {\n            try {\n                // Force webcam refresh\n                const video = webcamRef.current.video;\n                if (video) {\n                    video.srcObject = await navigator.mediaDevices.getUserMedia({\n                        video: {\n                            width: 640,\n                            height: 480,\n                            frameRate: { ideal: 30 }\n                        }\n                    });\n                }\n\n                // Wait for new frame\n                await new Promise(resolve => setTimeout(resolve, 1000));\n\n                const imageSrc = webcamRef.current.getScreenshot();\n                if (!imageSrc) {\n                    console.error('Failed to capture webcam image');\n                    return;\n                }\n\n                const timestamp = new Date().toISOString();\n                console.log('Capturing frame at:', timestamp);\n\n                const response = await axios.post('http://localhost:5000/analyze-emotion', {\n                    image: imageSrc,\n                    timestamp: timestamp\n                }, {\n                    headers: {\n                        'Content-Type': 'application/json'\n                    }\n                });\n                \n                console.log('Frame stats:', response.data.frame_stats);\n                console.log('Emotion scores:', response.data.emotion_scores);\n                \n                if (response.data.needs_break) {\n                    setShowGame(true);\n                    if (emotionTimer) {\n                        clearInterval(emotionTimer);\n                        setEmotionTimer(null);\n                    }\n                }\n            } catch (error) {\n                console.error('Error analyzing emotion:', error.response?.data);\n            }\n        }\n    };\n\n    // Update the useEffect for emotion timer\n    useEffect(() => {\n        if (!showGame && !emotionTimer) {\n            const timer = setInterval(checkEmotion, 5 *  1000); // 5 minutes\n            setEmotionTimer(timer);\n        }\n        return () => {\n            if (emotionTimer) {\n                clearInterval(emotionTimer);\n            }\n        };\n    }, [showGame, emotionTimer]);\n\n    const handleQuiz = async () => {\n        try {\n            // Check if quiz already completed\n            const quizStatusResponse = await axios.get(\n                `http://localhost:8080/courses/${courseId}/lessons/${lessonId}/users/${user.id}/quiz-status`\n            );\n\n            if (quizStatusResponse.data && quizStatusResponse.data.completed) {\n                // Mark course as in progress if this is the first completed lesson\n                if (completedLessons.length === 0) {\n                    try {\n                        await axios.post(`http://localhost:8080/users/${user.id}/courses/${courseId}/in-progress`);\n                    } catch (error) {\n                        console.error('Error marking course as in progress:', error);\n                    }\n                }\n\n                // Navigate to next lesson or quiz\n                const currentLessonIndex = course.lessons.findIndex(l => l.id === parseInt(lessonId));\n                const nextLesson = course.lessons[currentLessonIndex + 1];\n                \n                if (nextLesson) {\n                    navigate(`/learn/${courseId}/${nextLesson.id}`);\n                } else {\n                    // No more lessons, check if final quiz is available\n                    const finalQuizResponse = await axios.get(\n                        `http://localhost:8080/courses/${courseId}/final-quiz`\n                    );\n                    if (finalQuizResponse.data) {\n                        navigate(`/courses/${courseId}/final-quiz`);\n                    } else {\n                        navigate(`/courses/${courseId}`);\n                    }\n                }\n            } else {\n                // Quiz not completed, navigate to lesson quiz\n                navigate(`/courses/${courseId}/lessons/${lessonId}/quiz`);\n            }\n        } catch (error) {\n            console.error('Error checking quiz status:', error);\n            navigate(`/courses/${courseId}/lessons/${lessonId}/quiz`);\n        }\n    };\n\n    const handleLessonClick = (clickedLessonId) => {\n        if (!course?.lessons) return;\n\n        const lessonIndex = course.lessons.findIndex(l => l.id === clickedLessonId);\n        \n        // If completedLessons is empty (due to API error), allow clicking any lesson\n        if (completedLessons.length === 0) {\n            navigate(`/learn/${courseId}/${clickedLessonId}`);\n            return;\n        }\n\n        const previousLessonsCompleted = course.lessons\n            .slice(0, lessonIndex)\n            .every(l => completedLessons.some(cl => cl.id === l.id));\n\n        if (completedLessons.some(cl => cl.id === clickedLessonId) || previousLessonsCompleted) {\n            navigate(`/learn/${courseId}/${clickedLessonId}`);\n        } else {\n            alert('Please complete previous lessons first');\n        }\n    };\n\n    if (loading) {\n        return (\n            <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" minHeight=\"100vh\">\n                <CircularProgress />\n            </Box>\n        );\n    }\n\n    if (error) {\n        return (\n            <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" minHeight=\"100vh\">\n                <Typography color=\"error\">{error}</Typography>\n            </Box>\n        );\n    }\n\n    return (\n        <Container>\n            <Typography variant=\"h4\" component=\"h1\" mt={4}>\n                {course.name}\n            </Typography>\n            <Box display=\"flex\" mt={4}>\n                <Box flex={1}>\n                    {lesson.youtubeVideoLink && !videoError && (\n                        <Box mb={3}>\n                            <YouTube \n                                videoId={getYouTubeVideoId(lesson.youtubeVideoLink)} \n                                opts={youtubeOpts}\n                                onError={(error) => {\n                                    setVideoError(true);\n                                    console.error('YouTube Error:', error);\n                                }}\n                            />\n                        </Box>\n                    )}\n                    {videoError && (\n                        <Box mb={3}>\n                            <Typography color=\"error\">\n                                Failed to load video. Please check your internet connection.\n                            </Typography>\n                        </Box>\n                    )}\n                    <Box mt={2}>\n                        <Button variant=\"contained\" color=\"primary\" onClick={handleQuiz}>\n                            Attend Quiz\n                        </Button>\n                    </Box>\n                    <Typography variant=\"h6\" component=\"h2\" mt={2}>\n                        {lesson.name}\n                    </Typography>\n                    <Typography variant=\"body1\" component=\"p\" mt={2}>\n                        {lesson.description}\n                    </Typography>\n                </Box>\n                <Box ml={4} width=\"300px\">\n                    <Typography variant=\"h6\" component=\"h2\">\n                        Lessons\n                    </Typography>\n                    <List>\n                        {course.lessons.map((l) => (\n                            <ListItem\n                                key={l.id}\n                                onClick={() => handleLessonClick(l.id)}\n                                sx={{  // Using sx prop instead of style\n                                    backgroundColor: completedLessons.some(cl => cl.id === l.id) \n                                        ? '#d3ffd3' \n                                        : '#ffd3d3',\n                                    cursor: 'pointer', // Add pointer cursor\n                                    '&:hover': {\n                                        opacity: 0.9\n                                    }\n                                }}\n                            >\n                                <ListItemIcon>\n                                    {completedLessons.some(cl => cl.id === l.id) ? (\n                                        <CheckCircleIcon color=\"primary\" />\n                                    ) : (\n                                        <RadioButtonUncheckedIcon color=\"secondary\" />\n                                    )}\n                                </ListItemIcon>\n                                <ListItemText primary={l.name} />\n                            </ListItem>\n                        ))}\n                        {/* Final Quiz List Item */}\n                        <ListItem\n                            onClick={() => {\n                                if (isFinalQuizEnabled(course, completedLessons)) {\n                                    navigate(`/courses/${courseId}/final-quiz`);\n                                } else {\n                                    alert('Please complete all lessons before attempting the final quiz');\n                                }\n                            }}\n                            sx={{\n                                backgroundColor: '#f0f0f0',\n                                cursor: 'pointer',\n                                '&:hover': {\n                                    opacity: 0.9\n                                },\n                                marginTop: 1,\n                                borderTop: '2px solid #ddd'\n                            }}\n                        >\n                            <ListItemIcon>\n                                <RadioButtonUncheckedIcon color=\"primary\" />\n                            </ListItemIcon>\n                            <ListItemText \n                                primary=\"Final Quiz\"\n                                secondary={isFinalQuizEnabled(course, completedLessons) ? \n                                    \"Ready to take\" : \n                                    \"Complete all lessons first\"} \n                            />\n                        </ListItem>\n                    </List>\n                </Box>\n            </Box>\n            <Webcam\n                ref={webcamRef}\n                screenshotFormat=\"image/jpeg\"\n                style={{ display: 'none' }}\n                videoConstraints={{\n                    width: 640,\n                    height: 480,\n                    facingMode: \"user\",\n                    frameRate: { ideal: 30 }\n                }}\n                audio={false}\n                mirrored={false}\n                screenshotQuality={1.0}\n                forceScreenshotSourceSize={true}\n                onUserMedia={() => console.log('Webcam initialized')}\n                onUserMediaError={(err) => console.error('Webcam error:', err)}\n            />\n            <PopupGame \n                open={showGame}\n                onClose={() => {\n                    setShowGame(false);\n                    // Resume emotion detection timer\n                    if (!emotionTimer) {\n                        const timer = setInterval(checkEmotion, 5 * 60 * 1000);\n                        setEmotionTimer(timer);\n                    }\n                }}\n            />\n        </Container>\n    );\n};\n\nexport default Learn;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}